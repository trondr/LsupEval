$files = @()
$files += "CheckBoardID.exe"
$files += "CheckWDrive.exe"
$files += "HSW_vProChecker.exe"
$files += "L831_DetectVerTool.exe"
$files += "L83x_DetectVerTool.exe"
$files += "Lenovo_X_Rite_VerificationTool.exe"
$files += "UpdateIntelGbENVMW64e.exe"
$files += "UpdateIntelGbENVMW64e_2.exe"
$files += "apschk64.exe"
$files += "apschk86.exe"
$files += "bfudet.exe"
$files += "chk_tool.exe"
$files += "chk_ver.exe"
$files += "cyd001ww_version.exe"
$files += "d_f18buh02.exe"
$files += "d_f18puh03.exe"
$files += "d_f18uuh03.exe"
$files += "detect1909ur.exe"
$files += "detect1910.exe"
$files += "detect1911.exe"
$files += "detect_version_cs18_dp.exe"
$files += "detectnvme.exe"
$files += "detecttvsu.exe"
$files += "f18apd02_version.exe"
$files += "fhybd13_version.exe"
$files += "fusbcd05_version.exe"
$files += "fwchksd.exe"
$files += "fwdptv08_version.exe"
$files += "fwoldp01_version.exe"
$files += "getpackratinfo.exe"
$files += "getw10rsver.exe"
$files += "getw10ver4.exe"
$files += "getw10ver5.exe"
$files += "getw10ver6.exe"
$files += "getw10ver7.exe"
$files += "iap1001_P52_version.exe"
$files += "iap1003_yoda2_version.exe"
$files += "iap1004_RV2_version.exe"
$files += "iap1004_RV3_version.exe"
$files += "inboxdrivercheck.exe"
$files += "l83x_detectvertool.exe"
$files += "mefwdetect.exe"
$files += "n1cgf02w_version.exe"
$files += "n1fgf03w_version.exe"
$files += "n1ggf09w_version.exe"
$files += "n1lkf16w_version.exe"
$files += "n1mir07w_version.exe"
$files += "n1nic07w_version.exe"
$files += "n1olk08w_version.exe"
$files += "n1qib04w_version.exe"
$files += "n1qid09w_version.exe"
$files += "n1vfb04w_version.exe"
$files += "n1vfc07w_version.exe"
$files += "n20bi08w_version.exe"
$files += "n22bi04w_version.exe"
$files += "n22ci09w_version.exe"
$files += "n24ci07w_version.exe"
$files += "n25ib06w_version.exe"
$files += "n25pf03w_version.exe"
$files += "n27ci01w_version.exe"
$files += "n2cbi02w_version.exe"
$files += "n2ebi03w_version.exe"
$files += "n2eci04w_version.exe"
$files += "n2hcb03w_version.exe"
$files += "n2hpf01w_version.exe"
$files += "n2ias05w_version.exe"
$files += "n2ibs03w_versioncheck.exe"
$files += "n2ics03w_version.exe"
$files += "n2ils05w_version.exe"
$files += "n2jac03w_version.exe"
$files += "n2jbc04w_versioncheck.exe"
$files += "n2jcc03w_version.exe"
$files += "n2jlc04w_versioncheck.exe"
$files += "n2jsf02w_version.exe"
$files += "p50_p70_detect.exe"
$files += "r0scb09w_version.exe"
$files += "r0tcd06w_version.exe"
$files += "r0xcf01w_versioncheck.exe"
$files += "r10cc03w_version.exe"
$files += "raydium_fwdet.exe"
$files += "tps65988_detecttool.exe"
$files += "tr_tbtdockfw06_version.exe"
$files += "usi002_tesla_version.exe"
$files += "usi002_vl812_5041_version.exe"
$files += "win81checker.exe"
$files += "wldcgt03_check_update.exe"

$remaining = $files | Where-Object { (Test-Path "c:\temp\$($_)") -eq $false }

$sources = @()
$sources += "https://download.lenovo.com/cdrt/drivers/"
$sources += "https://download.lenovo.com/consumer/desktop/"
$sources += "https://download.lenovo.com/consumer/mobiles/"
$sources += "https://download.lenovo.com/ibmdl/pub/pc/pccbbs/mobiles/"
$sources += "https://download.lenovo.com/ibmdl/pub/pc/pccbbs/thinkcentre_drivers/"
$sources += "https://download.lenovo.com/mobilesjp/"
$sources += "https://download.lenovo.com/pccbbs/mobiles/"
$sources += "https://download.lenovo.com/pccbbs/thinkcentre_bios/"
$sources += "https://download.lenovo.com/pccbbs/thinkcentre_drivers/"


$remaining | ForEach-Object { 
    $targetFile = "$($_)"
    $targetFilePath = "C:\temp\$($_)"
    $sources | ForEach-Object {
            $sourceFolder = $($_)
            $sourceFile = "$($sourceFolder)/$($targetFile)"
            If( (Test-Path -Path $targetFilePath) -eq $false  )
            {        
                Invoke-WebRequest -Uri "$($sourceFile)" -OutFile "$($targetFilePath)" 
            }
        }
    }
    

